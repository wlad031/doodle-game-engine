CMAKE_MINIMUM_REQUIRED(VERSION 3.3.0)
PROJECT(DoodleGameEngine)

# Set some useful path-variables
SET(BUILD_DIRECTORY_NAME "build")
SET(INCLUDE_DIRECTORY_NAME "include")
SET(BINARY_DIRECTORY_NAME "bin")
SET(LIB_DIRECTORY_NAME "lib")
SET(ARCHIVE_DIRECTORY_NAME "archive")

SET(PROJECT_DIRECTORY \"${PROJECT_SOURCE_DIR}/\")
SET(PROJECT_LIB_DIRECTORY ${PROJECT_SOURCE_DIR}/${LIB_DIRECTORY_NAME})

SET(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${PROJECT_SOURCE_DIR}/${BUILD_DIRECTORY_NAME}/${ARCHIVE_DIRECTORY_NAME})
SET(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${PROJECT_SOURCE_DIR}/${BUILD_DIRECTORY_NAME}/${LIB_DIRECTORY_NAME})
SET(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${PROJECT_SOURCE_DIR}/${BUILD_DIRECTORY_NAME}/${BINARY_DIRECTORY_NAME})

SET(INCLUDE_DIRECTORY \"${ABSOLUTE_SOURCE_DIR}/${INCLUDE_DIRECTORY_NAME}/\")

SET_TARGET_PROPERTIES(
        PROPERTIES
        ARCHIVE_OUTPUT_DIRECTORY CMAKE_ARCHIVE_OUTPUT_DIRECTORY
        LIBRARY_OUTPUT_DIRECTORY CMAKE_LIBRARY_OUTPUT_DIRECTORY
        RUNTIME_OUTPUT_DIRECTORY CMAKE_RUNTIME_OUTPUT_DIRECTORY
)

# Set compiler options
set(CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS}")
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++14 -w")

# Add external projects
INCLUDE(ExternalProject)

# Easyloggingpp
MESSAGE(STATUS "GitHub: Easyloggingpp")

SET(EASYLOGGINGPP_DIRECTORY ${CMAKE_LIBRARY_OUTPUT_DIRECTORY}/Easyloggingpp)
SET(EASYLOGGINGPP_BUILD_DIRECTORY ${CMAKE_LIBRARY_OUTPUT_DIRECTORY}/${BUILD_DIRECTORY}/Easyloggingpp)

MESSAGE(STATUS " > EASYLOGGINGPP_DIRECTORY ${EASYLOGGINGPP_DIRECTORY}")
MESSAGE(STATUS " > EASYLOGGINGPP_BUILD_DIRECTORY ${EASYLOGGINGPP_BUILD_DIRECTORY}")

EXTERNALPROJECT_ADD(
        Easyloggingpp
        GIT_REPOSITORY https://github.com/easylogging/easyloggingpp
        GIT_TAG v9.83
        SOURCE_DIR ${EASYLOGGINGPP_DIRECTORY}
        BINARY_DIR ${EASYLOGGINGPP_BUILD_DIRECTORY}
        UPDATE_COMMAND ""
        PATCH_COMMAND ${CMAKE_COMMAND} -E copy ${EASYLOGGINGPP_DIRECTORY}/CMakeLists.txt ${CMAKE_BINARY_DIR}/Easyloggingpp/CMakeLists.txt
        CMAKE_GENERATOR ${gen}
        CMAKE_ARGS
        ${ep_common_args}
        -DCMAKE_BUILD_TYPE:STRING=Release
        -DCMAKE_INSTALL_PREFIX:PATH=${CMAKE_BINARY_DIR}/INSTALL
)

SET(EASYLOGGINGPP_INCLUDE ${CMAKE_BINARY_DIR}/INSTALL/include)

MESSAGE(STATUS " > EASYLOGGINGPP_INCLUDE ${EASYLOGGINGPP_INCLUDE}")
INCLUDE_DIRECTORIES("${EASYLOGGINGPP_INCLUDE}")

# Add source directories
AUX_SOURCE_DIRECTORY(src SOURCE_DIRECTORY)

SET(
        SOURCE_FILES
        entrypoint.cpp
        ${SOURCE_DIRECTORY}
)

ADD_EXECUTABLE(
        DoodleGameEngine
        ${SOURCE_FILES}
)

INCLUDE_DIRECTORIES(
        src/
        "${PROJECT_BINARY_DIR}"
)

TARGET_LINK_LIBRARIES(
        DoodleGameEngine
)

ADD_DEPENDENCIES(DoodleGameEngine Easyloggingpp)
